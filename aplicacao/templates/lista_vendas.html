{% load bootstrap4 %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histórico de Vendas</title>
    {% bootstrap_css %}
</head>
<body>
<div class="container my-4">
    <h1>Histórico de Vendas</h1>
    <hr>
    
    <a href="{% url 'url_produto' %}" class="btn btn-secondary mb-3">Voltar</a>

    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col">ID da Venda</th>
                <th scope="col">Cliente</th>
                <th scope="col">Data</th>
                <th scope="col">Valor Total</th>
            </tr>
        </thead>
        <tbody>
            {% for venda in vendas %}
            <tr>
                <th scope="row">{{ venda.id }}</th>
                <td>{{ venda.cliente.nome }}</td>
                <td>{{ venda.data_venda|date:"d/m/Y H:i" }}</td>
                <td>R$ {{ venda.valor_total }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">Nenhuma venda registrada ainda.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="container my-4">
    <h2>Análises de Avaliações</h2>
    {% if grafico_usuarios_ativos %}
        <h4>Top 15 Usuários Mais Ativos</h4>
        <img src="data:image/png;base64,{{ grafico_usuarios_ativos }}" alt="Gráfico de Usuários Mais Ativos" class="img-fluid mb-4">
    {% endif %}
    {% if grafico_evolucao_reviews %}
        <h4>Evolução do Número de Avaliações por Ano</h4>
        <img src="data:image/png;base64,{{ grafico_evolucao_reviews }}" alt="Gráfico de Evolução das Avaliações" class="img-fluid mb-4">
    {% endif %}
    {% if grafico_preco_score %}
        <h4>Correlação entre Preço e Nota da Avaliação</h4>
        <img src="data:image/png;base64,{{ grafico_preco_score }}" alt="Gráfico de Preço vs. Score" class="img-fluid mb-4">
    {% endif %}
    {% if grafico_sentimento %}
        <h4>Distribuição de Sentimentos nos Sumários das Avaliações</h4>
        <img src="data:image/png;base64,{{ grafico_sentimento }}" alt="Gráfico de Análise de Sentimento" class="img-fluid mb-4">
    {% endif %}
</div>
</body>
</html>